<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>じゃんけん</title>

        <!-- CSS読み込み -->
        <link rel="stylesheet" href="css/style.css" />

        <!-- jQuery読み込み -->
        <script src="js/jquery-3.7.1.min.js"></script>
    </head>
<body>
<header>
    <h1>じゃんけん</h1>
</header>

<main>
    <div class="card">
        <div class="result-area">
            <div>
                コンピュータの手 <span id="pc-hand" style="display: inline-block; width: 6em; height: 1.5em; line-height: 1.5em; vertical-align: middle; text-align: center;">？　？？</span>
            </div>
        <ul class="choices">
            <li id="gu" class="choice-btn">✊ グー</li>
            <li id="choki" class="choice-btn">✌️ チョキ</li>
            <li id="pa" class="choice-btn">✋ パー</li>
        </ul>
            <div id="result" class="result">あなたの手を選んでください</div>
            <div class="score-area">
            <p><span id="score-ratio">0勝0敗 / 0戦</span></p>
            </div>
        </div>
    </div>
</main>

<script>

// じゃんけんゲームの JavaScript を記述してください！

$(function() {
    // スロット用の設定
    const hands = ["✊　グー", "✌️　チョキ", "✋　パー"];
    let slotId; // スロットを管理するためのID
    let count = 0; // スロットの回転用カウント

    // カウンター用の変数
    let winCount = 0;
    let lossCount = 0;
    let drawCount = 0;

    // スロットを開始する関数
    function startSlot() {
        slotId = setInterval(function() {
            $("#pc-hand").html(hands[count % 3]);
            count++;
        }, 60);
    }

    // ページ読み込み時にスロットを開始
startSlot();

    // じゃんけんゲーム部分
$(".choice-btn").on("click", function(){   
        // スロットを即座に停止
        clearInterval(slotId);

        // 1. 自分の手を数字に変換 (idを使って判定)
        const id = $(this).attr("id");
        let userHand;
        if (id === "gu") userHand = 0;
        else if (id === "choki") userHand = 1;
        else userHand = 2;

        // 2. コンピュータの手をランダムに決定
        const pcHand = Math.floor(Math.random() * 3);
        
        // 3. 画面に表示
        // const hands = ["✊ グー", "✌️ チョキ", "✋ パー"]; // 上部で定義済みのためコメントアウト可
        $("#pc-hand").html(hands[pcHand]);

        // 4. 勝敗判定 (mod3 ロジック)
        const resultNum = (userHand - pcHand + 3) % 3;
        const resultMsg = ["アイコ", "負け", "勝ち"];

        // 5. 結果を表示
        $("#result").html(resultMsg[resultNum]);

        // 6. 勝った時に色を変える
        if (resultNum === 1) {
            $("#result").css("color", "blue");
            lossCount++; // 負け数をカウント
        } else if (resultNum === 2) {
            $("#result").css("color", "red");
            winCount++; // 勝ち数をカウント
        } else {
            $("#result").css("color", "black");
            drawCount++; // あいこ数をカウント
        }

        // --- 勝敗カウンターの表示更新 ---
        const totalMatches = winCount + lossCount; // 合計戦数を計算
        $("#score-ratio").html(winCount + "勝" + lossCount + "敗 / " + totalMatches + "戦");

        // 次のゲームのための処理
        $(".choice-btn").css("pointer-events", "none"); // 連打防止

        setTimeout(function() {
            $("#result").html("手を選んでください");
            $("#result").css("color", "black");
            $(".choice-btn").css("pointer-events", "auto"); // ボタン有効化
            startSlot(); // スロット再開
        }, 2000);
    });
});

// じゃんけんアプリ概要 -----------------------------------------------
// 
// 【基本機能】
// - プレイヤーがグー・チョキ・パーのボタンをクリックできる
// - コンピュータがランダムに手を選ぶ
// - 勝敗を判定して結果を表示する
// - 結果に応じて色分け表示する
// 
// 【画面構成】ID
// - #gu ボタン: グーを選択
// - #choki ボタン: チョキを選択  
// - #pa ボタン: パーを選択
// - #pc-hand: コンピュータの手を表示
// - #result: 勝敗結果を表示

// <アルゴリズム＞
// 
// 開始
// プレイヤー(P)がグー・チョキ・パーの手を選択する（ボタンをクリックする）
// コンピュータ(C)がー・チョキ・パーの手を選択する
// 相手の手と比較し、それぞれ勝敗がつけられる *設定
//  双方の手が一致した場合、「アイコ」となる
//  プレイヤーの手が勝ちの場合、「勝ち」と表示する
//  プレイヤーの手が負けの場合、「負け」と表示する
// 終了

// *設定: グー=0, チョキ=1, パー=2 

// <差>
//.     グー チョ パー
// グー   0  -1  -2    dwl
// チョ   1   0  -1    ldw
// パー   2   1   0    wld
// 
// <差(mod3)> *+3して正負調整
//.     グー チョ パー
// グー   0   2   1    dwl
// チョ   1   0   2    ldw
// パー   2   1   0    wld
// 
// → アイコd=0, 負けl=1, 勝ちw=2 として定義

// ---------------------------------------------------------------

</script>
</body>
</html>


